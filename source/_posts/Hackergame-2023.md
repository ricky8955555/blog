---
title: Hackergame 2023 总结 + 个人题解
date: 2023-11-05 15:22:07
tags: [CTF]
categories: [其他]
---

![](hgys-bg.webp)

Hackergame 启动！Hackergame 关闭！

<!-- more -->

Hackergame 算是我第一次正经参与 CTF 比赛。本来就抱着试着玩玩的心态去参与的~~（然后没想到越玩越起劲）~~，实际上自己对计算机很多知识都是一直半解，在玩的过程中遇到了不少的困难，但是感谢现在搜索引擎以及机器学习的强大，了解到了许多未曾听闻的知识，感谢 Hackergame 让我学到了这么多东西w。

![](Screenshot_20231105_154014.webp)

但最后我拿到了 4200 分，总排名 98 / 2381 是我完全没想到的（x

# 个人题解

## 🌐 Hackergame 启动

最最最简单的一题x

我在做这题的时候压根没录音就提交上去了，然后看到了 URL 多了个 `?similarity=` 参数，然后我就瞎摸着传入个 `100`，然后就出现仿某神的界面了（

![](Screenshot_20231105_154706.webp)


## 💻 猫咪小测

搜集资料的问答题x

### 第一问

> 1. 想要借阅世界图书出版公司出版的《A Classical Introduction To Modern Number Theory 2nd ed.》，应当前往中国科学技术大学西区图书馆的哪一层？**（30 分）**

看到 **中国科学技术大学西区图书馆**，我便第一时间想到去寻找中科大的图书馆官网。通过搜索引擎也确实找到了。

接下来便是要利用官网的检索系统进行书籍检索了，但是搜索的时候不能直接复制粘贴（因为有可能图书的命名不太一样），通过检索关键词 `A Classical Introduction To Modern Number Theory` 便能检索到该书籍在中科大图书馆的分类及编号。

![](Screenshot_20231105_155823.webp)
![](Screenshot_20231105_155954.webp)
![](Screenshot_20231105_160207.webp)

可以看到下方写着该书籍馆藏于 *西区外文书库*，但显然作为校外人员的我没法知道 *西区外文书库* 在哪。

返回到主页，可以注意到导航栏 *本馆概况* 下有栏目 [*馆藏分布*](https://lib.ustc.edu.cn/%e6%9c%ac%e9%a6%86%e6%a6%82%e5%86%b5/%e9%a6%86%e8%97%8f%e5%88%86%e5%b8%83/)，在里面便能轻松找到 *西区外文书库* 的楼层为 **12** 楼。

![](Screenshot_20231105_161228.webp)
![](Screenshot_20231105_160913.webp)

于是得到第一题的答案：`12`。

### 第二问

> 2. 今年 arXiv 网站的天体物理版块上有人发表了一篇关于「可观测宇宙中的鸡的密度上限」的论文，请问论文中作者计算出的鸡密度函数的上限为 10 的多少次方每立方秒差距？**（30 分）**

~~感谢 Hackergame 让我知道了 arXiv 这个论文档案库（~~

进入 [arXiv](https://arxiv.org) 后，检索 *可观测宇宙中的鸡的密度上限* 论文，但显然不能直接搜索中文，于是我利用我贫穷的英语知识大概提炼了一下关键词 `
chicken density universe`，于是搜索到了题为 [*Nuggets of Wisdom: Determining an Upper Limit on the Number Density of Chickens in the Universe*](https://arxiv.org/abs/2303.17626) 的论文。

![](Screenshot_20231105_162357.webp)

通过查看论文的 *Abstract*（~~抽象~~ 概要）部分，可以快速地找到关键词 *upper limit* 以及对应的数量级 **1e23**。

于是得到第二题的答案：`23`。

### 第三问

> 3. 为了支持 TCP BBR 拥塞控制算法，在**编译** Linux 内核时应该配置好哪一条内核选项？（20 分）

依旧依靠搜索引擎的强大能力（因为自己对 Linux 内核编译以及 BBR 不太了解），通过关键词 `linux kernel tcp bbr congestion control` 在搜索引擎搜索，可以找到对应的指导文章。

![](Screenshot_20231105_163225.webp)
![](Screenshot_20231105_163708.webp)

不难发现对应的参数说明，但此处有两个参数，题目只需要一个，便拿出了最贴切题目 *TCP BBR 拥塞控制算法* 的 **CONFIG_TCP_CONG_BBR** 作为尝试，最终答案也的确是这个。

于是得到第三题的答案：`CONFIG_TCP_CONG_BBR`。

### 第四问

> 4. 🥒🥒🥒：「我……从没觉得写类型标注有意思过」。在一篇论文中，作者给出了能够让 Python 的类型检查器 ~~MyPY~~ mypy 陷入死循环的代码，并证明 Python 的类型检查和停机问题一样困难。请问这篇论文发表在今年的哪个学术会议上？**（20 分）**

依旧依靠搜索引擎的强大能力（

提炼关键词 `Python 类型检查 停机问题` (`python type checking halting problem`)，最终可以定位到一篇名为 [*Python type hints are Turing complete*](https://arxiv.org/abs/2208.14755) 的论文。

再以论文标题作为检索词扔进搜索引擎搜索，最终可定位到这篇论文与 *ECOOP 2023* 相关，再进一步资料搜索，可以了解到 *ECOOP* 全名 *European Conference on Object-Oriented Programming*，可确定这是一场学术会议。

![](Screenshot_20231105_164941.webp)
![](Screenshot_20231105_165104.webp)

于是得到第三题的答案：`ECOOP`。

## 🌐 更深更暗

~~♪ 悲しみの海に沈んだ私~~

这道题你是不能直接通过滑动网页划到底的~~（因为是个无底深渊~~，但实际上也很简单。

> 我刚刚有一瞬间好像在残骸上看到了一个 flag？

这道题只要通过审查元素/检查功能，根据题目说的，找到最底下的元素 id 为 `titan` 残骸，把它展开就能看到 flag 了。

![](Screenshot_20231105_170520.webp)

## 💻 旅行照片 3.0

~~一年一度的开盒题！（bushi~~

一开始想用 EXIF 解题的（但发现压根就没有x），然后只能一点点地从字里行间以及图片细节提取信息了（这道题应该做了两三天了x）。

### 神秘奖牌

![](travelling-01.webp)

通过 Google Lens 等识图技术，或者将奖牌四周的文字一检索可以很快地找到这是一个诺贝尔奖牌，同时也能看到获奖人为 *M. KOSHIBA*。

![](Screenshot_20231105_171136.webp)

进一步检索可以找到获奖人全名为 *小柴昌俊（Masatoshi Koshiba）*，生前工作于 *東京大学（东京大学, The University of Tokyo）*。

> 2、在学校该展厅展示的所有同种金色奖牌的得主中，出生最晚者获奖时所在的研究所缩写是什么？

通过第二题的任务驱动，再根据 *在校园的一个展厅内，你发现了一枚神秘的金色奖牌* 可猜测这枚奖牌位于 東京大学 某个展厅内。

于是我在搜索引擎上检索 `東京大学 ノーベル賞 展示`（`东京大学 诺贝尔奖 展示`），便找到了我们需要的获奖者信息（甚至那个页面已经给出了出生年份了）。

![](Screenshot_20231105_173221.webp)

经过对比可以看到出生最晚者名为 *梶田隆章（Takaaki Kajita）*，从介绍中可看到其身份为 *宇宙線研究所教授*。通过检索 `東京大学宇宙線研究所`，不难找到它的简称为 *ICRR*。

![](Screenshot_20231105_173744.webp)

于是得到第二题的答案：`ICRR`

![](travelling-02.webp)

看到第二张图片，以及文中提到 *学长（下图左一）与你分享了不少学校的趣事*，可以注意到图片中哪位是学长，以及学长挂的牌子上面赫然写着 **STATPHYS28**。

![](Screenshot_20231105_174334.webp)

通过检索可以发现这是一个国际学术活动，也能推断出学长当日是在参加该活动。

> 1、你还记得与学长见面这天是哪一天吗？（格式：yyyy-mm-dd）

进入 [*STATPHYS28* 官网](https://statphys28.org) 可以看到活动时间为 *August 7th-11th, 2023*。

![](Screenshot_20231105_175216.webp)

因此 *2023-08-07* 到 *2023-08-11* 都尝试一下就好了，最后可以发现答案为 *2023-08-10*。

于是得到第一题的答案：`2023-08-10`

### 这是什么活动？

![](travelling-03.webp)

> 当你们走到一座博物馆前时，马路对面的喷泉和它周围的景色引起了你的注意。下午，白色的帐篷里即将举办一场大型活动，人们忙碌的身影穿梭其中，充满了期待与热情。

看到这图我立刻扔给 Google Lens 了（x

![](Screenshot_20231105_180116.webp)

大致地信息处理后，可了解到拍摄地为 *上野恩賜公園（上野恩赐公园, Ueno Park）*。

> 3、帐篷中活动招募志愿者时用于收集报名信息的在线问卷的编号（以字母 S 开头后接数字）是多少？

但在这步之后我锁定的地方错了，因为通过检索，我了解到了 *上野の森美術館（上野之森美术馆, The Ueno Royal Museum）* 位于 *上野恩賜公園*，里面也有符合对应时间段的展览 *日本の自然を描く展* 以及 *野田哲也の版画―Ⅲ～静かなるもの～*，锁定在这里面已经是有一两天的时间了，但我费尽九牛二虎之力也没法找到对应的志愿者招募信息，于是放弃锁定 *上野の森美術館*。

![](Screenshot_20231105_181410.webp)

后面就以 `上野恩賜公園 8月10日` 作为关键词进行检索，便找到了 *全国梅酒まつりin東京2023* 的活动。

![](Screenshot_20231105_181836.webp)

根据网站的链接找到了其 [官网](https://umeshu-matsuri.jp)，经过内容阅读，可以发现网页底部有我们想要的志愿者招募（*ボランティアSTAFF募集*）信息链接，里面也有我们需要的问卷调查编号 *S495584522*。

![](Screenshot_20231105_182051.webp)
![](Screenshot_20231105_182308.webp)

于是得到第三题的答案：`S495584522`

> 4、学长购买自己的博物馆门票时，花费了多少日元？

其实这道题我并没有真正地做出来，因为我理解错了，我以为是参与 *全国梅酒まつりin東京2023* 活动所需要的金额。

由于尝试了上面所述金额没有以后，随便试了个 0 就过了x。

![](Screenshot_20231105_182824.webp)

这题我的解题方法并没有参考价值，所以不加赘述，建议查看 [官方题解](https://github.com/USTC-Hackergame/hackergame2023-writeups/tree/master/official/%E6%97%85%E8%A1%8C%E7%85%A7%E7%89%87%203.0)。

### 后会有期，学长！

#### 第五题

> 5、学长当天晚上需要在哪栋标志性建筑物的附近集合呢？（请用简体中文回答，四个汉字）

根据文字描述 *学长那天晚上将继续他的学术之旅，打算乘船欣赏东京的迷人夜景和闪耀的彩虹大桥（Rainbow Bridge）*，结合上面分析到学长很可能参与的 *STATPHYS28* 活动，再次进入 *STATPHYS28* 官网了解详情。

##### 错误的方向

不难发现在 *STATPHYS28* 官网的导航栏，*Events* 下有栏目 [*Social Programs and Visits*](https://statphys28.org/socialprogram.html)。

![](Screenshot_20231105_185000.webp)

但发现符合条件的只有 *Tokyo Night View Tours* 活动，所述内容并不符合题目所说的 *乘船欣赏东京的迷人夜景*。

![](Screenshot_20231105_185715.webp)

##### 转向正确的方向

在 *Events* 导航栏下转来转去，最后锁定到了栏目 [*Banquet*](https://statphys28.org/banquet.html)。

里面的时间以及交通方式恰好符合，于是我猜测应该是这项活动。

![](Screenshot_20231105_190302.webp)

也在底部的 *Meeting Point* 一栏找到了集合点 *Yasuda Auditorium*。

![](Screenshot_20231105_190406.webp)

经过简单的检索，可以了解到该地点中文名为 *安田讲堂*。

![](Screenshot_20231105_190708.webp)

于是得到第五题的答案：`安田讲堂`

#### 第六题

> 6、进站时，你在 JR 上野站中央检票口外看到「ボタン＆カフリンクス」活动正在销售动物周边商品，该活动张贴的粉色背景海报上是什么动物（记作 A，两个汉字）？ 在出站处附近建筑的屋顶广告牌上，每小时都会顽皮出现的那只 3D 动物是什么品种？（记作 B，三个汉字）？（格式：A-B）

##### 第一小问

这一小问我没在搜索引擎上搜索出来什么，倒是在某 X 社交网站通过检索 `ボタン＆カフリンクス 上野駅` 找到了。

![](Screenshot_20231105_191639.webp)

于是得到第一小问的答案：`熊猫`

##### 第二小问

其实这道题我也并没有真正地做出来，因为我这也是理解错了，我以为是 *上野駅* 出口处的 3D 广告牌（实际那里没有）。

我就在搜索引擎的图片搜索功能用关键词 `上野 3D 広告` 检索，然后搜到个 *秋田犬*，扔进去竟然对了x

这题我的解题方法也同样没有参考价值，建议查看 [官方题解](https://github.com/USTC-Hackergame/hackergame2023-writeups/tree/master/official/%E6%97%85%E8%A1%8C%E7%85%A7%E7%89%87%203.0)。

于是得到第二小问的答案：`秋田犬`

结合上述结论，得到该题答案为：`熊猫-秋田犬`

## 🌐 赛博井字棋

在这题不难通过调试发现我们“下棋”的过程是通过 POST 方法实现的。

![](Screenshot_20231105_193850.webp)

思考了一番之后，突发奇想：在结束后 POST 一个机器人下的棋子并且取代之后会让我赢的点位会怎样呢？

然后给服务器 POST 了个 `{x: 0, y: 0}`，然后服务器就会返回个 flag 作为 `msg` 的响应。

![](Screenshot_20231105_194600.webp)

## 💻 奶奶的睡前 flag 故事

![](grandma-flag-story-screenshot.png)

注意到图片的 *在最后* 加粗提示，我便猜测可能在这个图片末尾的字节处应该有答案。利用 ImHex 也能看到 PNG 的 `IEND` 标识符后面确实有内容，但我没法解出来是什么东西。

然后利用 `binwalk` 工具看了一下，也没看出来什么东西。

于是过了几天再认真地看了一下题目加粗点 *谷歌的『亲儿子』* *连系统都没心思升级* *截图*，于是我在搜索引擎检索了关键词 `pixel screenshot vulnerability`，也确实搜集到了本题所利用的漏洞 *Acropalypse*。

![](Screenshot_20231105_195718.webp)

在 GitHub 上也找到了对应的工具，我这采用的是 [Acropalypse-Multi-Tool](https://github.com/frankthetank-music/Acropalypse-Multi-Tool)

经过工具的还原，可以看到本题利用该漏洞留下的 flag（原图分辨率随便选一个都行x）。

![](Screenshot_20231105_201051.webp)

## 🌐 组委会模拟器

> 本题中，你需要撤回的 "flag" 的格式为 `hack[...]`，其中**方括号**内均为小写英文字母，点击消息即可撤回。你需要在 3 秒内撤回消息，否则撤回操作将失败。在全部消息显示完成后等待几秒，如果你撤回的消息完全正确（撤回了全部需要撤回的消息，并且未将不需要撤回的消息撤回），就能获得本题**真正的 flag**。

经过阅读题目后，并且~~实地考察~~一番后，可以确定下来 `fakeqq-message__bubble` 的点击事件可以触发撤回消息操作，消息是由 id 为 `fakeqq-message__bubble` 的 `div` 元素下的 `span` 元素作显示的。

至于为什么不直接采用 POST，是因为 POST 方法会有点麻烦。

根据题目所描述的 flag 格式，可编写 RegEx 表达式 `hack\[[a-z]+\]` 进行匹配。

结合上述信息，通过定时轮询清理消息。题目要求 *3 秒内撤回消息*，但轮询操作不能过于频繁（不然你设备处理不来x），所以设定为 1s 即可。

接着可写出以下代码进行操作（当然代码可读性不强，~~能用就好~~）：

```javascript
const flagRegex = /hack\[[a-z]+\]/

function clean() {
    for (let i = 0; i < 1000; i++) {
        const bubble = document.querySelector(`#app > div > div.fakeqq-container > div:nth-child(${i + 1}) > div > div.fakeqq-message__content > div.fakeqq-message__bubble`)
        if (bubble && flagRegex.test(bubble.querySelector("span").innerText)) bubble.click()
    }
}

setInterval(clean, 1000)
```

# 未完待续

心血来潮写了一部分，然后有点累了，后面再更x
